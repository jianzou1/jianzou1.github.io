<!DOCTYPE html>
<html lang="zh">
<head>
</script>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="referrer" content="no-referrer" />
    
    <title>Archives: 2020/2 | 间奏 - 前往小島</title>
    <meta name="keywords" content="jianzou"/>
    <meta name="HandheldFriendly" content="True"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="google-site-verification" content=""/>
    <meta name="baidu-site-verification" content=""/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <meta name="description" content="Everyone is chasing their own dragon.">
<meta property="og:type" content="website">
<meta property="og:title" content="间奏 - 前往小島">
<meta property="og:url" content="https://jianzou.art/archives/2020/02/index.html">
<meta property="og:site_name" content="间奏 - 前往小島">
<meta property="og:description" content="Everyone is chasing their own dragon.">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="间奏">
<meta name="twitter:card" content="summary">
    

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,700" rel="stylesheet">

    
<link rel="stylesheet" href="/style.css">

    <script>
      function setLoadingBarProgress(num) {
        document.getElementById('loading-bar').style.width = num + "%";
      }
    </script>

    
<meta name="generator" content="Hexo 5.4.0"></head>

<body>

<div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>

<script>setLoadingBarProgress(5)</script>

<div id="site-wrapper">

    <header id="header">
    <meta name="referrer" content="no-referrer" />
    <div id="header-wrapper" class="clearfix">
        <a id="logo" href="/">
            <img src="/img/logo.png"/>
            <span id="site-desc">
                前往小島
            </span>
        </a>
        <button id="site-nav-switch">
            <span class="icon icon-menu"></span>
        </button>
    </div>
</header>
    <script>setLoadingBarProgress(10);</script>

    <main id="main" role="main">
        
    


  <section class="page-header archive">
    <h1>- <span>2020.2</span> -</h1>
  </section>




<section class="post-list">
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2020/gd_system/">
                复杂游戏系统设计与“涌现”理论
            </a>
        </h2>
    
    <time>
        2月 21, 2020
    </time>
    <section class="content">
        <h2><span id="什么是系统">什么是系统？</span></h2><p>系统的定义：系统是由一系列相互关联的组件组成的整体，这些组件之间的相互作用形成了系统的属性和行为，这些属性和行为不仅属于组件，还属于整个系统。</p>
<ul>
<li><strong>组件</strong>：它们具有内部状态、边界和行为。这些组件之间通过相互作用来形成系统的结构。</li>
<li><strong>相互作用</strong>：组件之间的相互作用通过行为实现，这些行为通常涉及资源（如信息或物质）的流动。系统中的相互作用可能会形成循环，这些循环对系统的行为产生深远影响。</li>
<li><strong>涌现</strong>：涌现是系统中强化循环和平衡循环的平衡状态，产生有组织的系统行为，这种行为不仅由组件的属性决定，还受到它们相互之间的关系影响。</li>
</ul>
<h2><span id="组件和互动">组件和互动</span></h2><h3><span id="组件components">组件（Components）</span></h3><p>在系统中，组件指系统的基本构建单元。每个组件都有内部状态、边界和行为。组件是系统中的节点，它们可以独立运作，并通过行为与其他组件互动。</p>
<ul>
<li><strong>状态（State）</strong>：组件的状态由多个属性组成，这些属性在任何给定时刻都具有特定的值。系统中的状态常常是从更低层级的子系统的状态聚合而成。</li>
<li><strong>边界（Boundaries）</strong>：每个组件都有边界，边界定义了组件的局部领域，其中与其他组件的互动比其他地方更频繁。边界可以有助于将系统的不同组件模块化，减少中心控制的需求。<ul>
<li>某些系统在顶层设计时，其中的若干模块就应该明确边界，在框架审查不严格的团队，甚至会出现双重开关的设计，增加迭代难度。</li>
</ul>
</li>
<li><strong>行为（Behaviors）</strong>：组件之间通过行为相互影响。这些行为会引发资源的流动，包括源、资源、容器和汇。资源可以是任何可数、可存储或可交换的东西，如生命值、子弹或资源领域。</li>
</ul>
<h3><span id="行为与资源流动">行为与资源流动</span></h3><ul>
<li><strong>源（Sources）</strong>：源是能够增加其他组件的资源数量的组件。源通常代表着某种资源的不断供应。其内部状态决定了资源的产生速率。<ul>
<li>如：MOBA游戏中的小兵、野怪，卡牌游戏中的PVE关卡。</li>
</ul>
</li>
<li><strong>资源（Resources）</strong>：资源代表从一个组件流向另一个组件的数量。资源可以是各种可计量、可存储或可交换的东西，包括物质和信息。<ul>
<li>如：玩家补兵获得金币，玩家完成关卡获得奖励。</li>
</ul>
</li>
<li><strong>容器（Containers）</strong>：容器接收和累积资源，其状态在某一时刻表示为一个数量。</li>
<li><strong>汇（Sinks）</strong>：汇是资源流向容器的出口。汇的行为是以每单位时间输出的资源数量来定义的，但当容器为空时，它不再能输出资源。</li>
</ul>
<h3><span id="强化循环与平衡循环">强化循环与平衡循环</span></h3><ul>
<li><strong>强化循环（Reinforcing Loops）</strong>：强化循环增强组件的行为，通常用于奖励成功和增强早期的优势。这种循环有时被称为“雪球”循环，因为即使优势很小，它也会被不断放大。</li>
<li><strong>平衡循环（Balancing Loops）</strong>：平衡循环减弱组件的行为，有助于维持或恢复系统中各组件的平衡。它通常会限制早期领先者，以避免差距不断扩大。</li>
<li>如：卡牌游戏中主线关卡的阶梯式数值体验设计，玩家通常在一个章节中，前n个小关卡中都能顺利通过（强化循环）。而直到玩家即将通关该章节时，难度陡增，甚至失败，则此时玩家需要前往其他系统进行数值养成（平衡循环），直至玩家在主线关卡的战力数值符合通关条件。</li>
</ul>
<h2><span id="意外后果与复合系统">意外后果与复合系统</span></h2><h3><span id="意外后果循环">意外后果循环</span></h3><p>意外后果循环是一种隐藏了一段时间的循环，最终以报复的方式返回系统中。这种循环通常是由于短期视野和系统性忽视导致的。意外后果循环的解决方法是细致地审查系统，并深入了解其中的潜在原因和影响。</p>
<ul>
<li>如：某货币的产出超限，游戏的拍卖行系统设置了系统自动求购，但没有为自动求购设计上限。</li>
<li>增长极限：我们经常会假设，给定一些结果，做更多会导致这样结果的事情，会带来相同方向持续不断的线性增长。这几乎是不可能的，原因在于：对于每一个由强化循环提供反馈的加速条件，都有一个由限制条件提供的单独的平衡循环。</li>
</ul>
<h3><span id="复合系统">复合系统</span></h3><p>复合系统由多个组件组成，这些组件通过形成循环连接在一起。复合系统的特点是，每个组件都影响自己未来的状态和行为。复合系统可以看作是系统中的系统，每个子系统都相对独立，但又与更大的系统相互作用。</p>
<ul>
<li>如：战队系统包含好友系统、活动系统包含商城系统。</li>
</ul>
<h3><span id="系统深度">系统深度</span></h3><p>系统深度是指组件存在于多个组织层级中，这些组件本身又由更低层级的组件组成。系统深度创造了多层次的结构，这些结构具有吸引力，因为它们易于上手，同时也具有不同层次的复杂性。系统深度允许我们构建复杂但可管理的系统，这些系统可以适应不同的需求和挑战。</p>
<h2><span id="涌现">涌现</span></h2><p>在游戏设计和复杂系统理论中，”涌现”（emergence）是一个重要概念，它指的是复杂系统中新的性质、行为、或模式从简单的组件或规则互动中产生的现象。这些新的性质通常不能简单地由组件的属性或规则的总和来预测，而是系统级别的表现。</p>
<ul>
<li><p>在游戏设计中，涌现意味着游戏中的复杂性不仅来自于单个游戏元素或机制，而是由这些元素之间的相互作用和组合产生的。这可以导致玩家在游戏中经历出乎意料的、独特的情境和挑战。游戏设计师可以利用涌现来创建更具深度和多样性的游戏体验，而不仅仅依赖于预定的剧情或规则。</p>
</li>
<li><p>举个例子，涌现在游戏中可以表现为玩家的行为和决策在不同的情境下引发了不同的结果，创造了非线性的游戏进程。这意味着玩家的互动和选择会导致游戏中的新情节或问题的出现，这些情节和问题是根据玩家的行为而演变的，而非事先设定好的。</p>
</li>
</ul>
<p>涌现在游戏中提供了更多的自由度和可能性，使游戏更富有挑战性和吸引力。设计师可以通过巧妙地设置游戏规则和元素之间的相互关系，鼓励玩家发现新策略、探索未知领域，并以独特的方式解决问题。这种设计方法可以增加游戏的回放价值，因为不同玩家在不同时间可能会经历不同的涌现情况。</p>
<p>在 “云顶之弈”（Teamfight Tactics）这款游戏中，让玩家从三个海克斯技能中选择一个的设计正是一个促使涌现的例子。这是一个很好的示范，显示了如何通过复杂的元素交互来创造非线性和多样性的游戏体验。</p>
<p>在游戏进程中，玩家会面临选择海克斯的阶段，可以选择拾取一个特定的装备，这个装备赋予棋子一个特定的技能或能力；也可以选择一个特定的技能，这个技能会影响棋子在战斗中的表现。这里的涌现来自于以下因素：</p>
<ol>
<li><strong>选择的多样性</strong>：每一轮提供给玩家的三个选项通常都是不同的技能或装备，它们可以为不同类型的棋子提供不同的效果。这创造了多种可能的策略和组合，促使涌现的出现。</li>
<li><strong>玩家的战术选择</strong>：玩家必须考虑他们当前的队伍构建、角色的职业和阵容，以及他们的游戏计划。这些因素会影响他们在每轮选择哪个装备的决策。</li>
<li><strong>互动效应</strong>：由于每个棋子可以携带多个装备，装备之间的互动效应也会涌现。不同装备的组合可能会创造出强大的效果，这种效果在游戏中并不是提前定义好的，而是由玩家的选择和实际战斗中的效果产生的。</li>
<li><strong>游戏进程的演变</strong>：由于游戏是逐渐发展的，玩家的队伍和战术也会随着时间演变。这意味着涌现的策略和效果会随着游戏的进行而变化，创造出不同的游戏体验。</li>
</ol>
<p>这个设计让 “云顶之弈” 充满了涌现性，因为它为玩家提供了丰富的选择和策略空间，每一轮都有可能涌现出不同的结果。这种设计方法使得游戏更具深度和多样性，同时也增加了玩家的决策和策略性。</p>
<h2><span id="优雅的系统思维">优雅的系统思维</span></h2><p>最终，系统思维的目标是创建优雅的系统。优雅的系统具有亚稳态，能够随时间变化，但仍然保持熟悉的感觉。这些系统具有层次深度和对称性，没有特殊情况或遗留问题。整个系统是由组件之间的相互作用形成的，因此整个系统具有高层次的定义，同时包含深层次的复杂性。</p>
<p>综上所述，系统思维是一种强大的工具，可用于理解复杂问题和设计创新系统。通过深入了解系统的组成组件、互动、涌现、系统深度和其他关键概念，我们能够更好地应对现实生活中的挑战，尤其是在游戏设计、系统工程和科学领域。系统思维有助于我们拆分复杂问题，找到解决方案，并优化系统以实现更好的性能和可持续性。</p>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/game-design/" rel="tag">game-design</a>
            </div>
        
    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2020/gd_sample_hero_ape/">
                角色设计：无聊猿
            </a>
        </h2>
    
    <time>
        2月 21, 2020
    </time>
    <section class="content">
        <h3><span id="更新日志">更新日志</span></h3><table>
<thead>
<tr>
<th>日期</th>
<th>内容</th>
<th align="left">作者</th>
</tr>
</thead>
<tbody><tr>
<td>2023年3月1日</td>
<td>创建文档</td>
<td align="left">朱兴韬</td>
</tr>
</tbody></table>
<h2><span id="一-设计目的">一、设计目的</span></h2><h3><span id="11-设计模型">1.1 设计模型：</span></h3><h4><span id="111-普通技能僵尸">1.1.1 普通技能：僵尸</span></h4><h5><span id="step-1-施放技能-僵尸">step 1: 施放技能 “僵尸”</span></h5><ul>
<li>玩家在关键时刻施放 “僵尸” 技能，享受做出决策的愉悦感，因为他们需要在危险情境下迅速反应，使自己进入无敌状态。</li>
</ul>
<h5><span id="step-2-技能状态持续">step 2: 技能状态持续</span></h5><ul>
<li>在技能状态持续期间，玩家体验到心流，因为他们需要不断地评估战斗情境，决定是否保持 “僵尸” 状态或恢复正常状态。</li>
<li>玩家在技能状态持续期间建立心智模型，了解何时最有效地利用无敌状态以获得优势。</li>
</ul>
<h5><span id="step-3-技能取消或技能结束">step 3: 技能取消或技能结束</span></h5><ul>
<li>玩家体验到满足感，因为他们根据游戏情境和对手行为的变化，做出决定是继续保持 “僵尸” 状态还是取消技能。</li>
<li>玩家通过技能的取消或结束建立心智模型，进一步了解技能的使用时机和有效性。</li>
</ul>
<h4><span id="112-大招技能-无聊领域">1.1.2 大招技能 “无聊领域”</span></h4><h5><span id="step-1-施放技能-无聊领域">step 1: 施放技能 “无聊领域”</span></h5><ul>
<li>玩家在施放 “无聊领域” 时体验到心流，因为这是一个关键的决策步骤，涉及一对一对决的选择，玩家充满期待。</li>
<li>玩家通过学习何时施放 “无聊领域” 建立心智模型，玩家需要考虑选择哪一位敌方英雄进行对决。</li>
</ul>
<h5><span id="step-2-技能状态持续">step 2: 技能状态持续</span></h5><ul>
<li>在 “无聊领域” 技能状态持续期间，玩家体验到心流，因为他们需要全神贯注地与对手一对一对决。</li>
<li>玩家在技能状态持续期间建立心智模型，了解如何最合适的在无聊领域中应对敌人的行为，以保持优势。</li>
</ul>
<h5><span id="step-3-技能状态结束">step 3: 技能状态结束</span></h5><ul>
<li>玩家在技能状态结束时可能会体验到满足感或挫败感，这取决于他们是否成功战胜了对手。</li>
<li>玩家通过技能状态的结束建立心智模型，通过决斗的方式击杀敌人，可获得满足感与成就感。</li>
</ul>
<h3><span id="12-设计风险">1.2 设计风险：</span></h3><ul>
<li>Q：使用无敌方式切入战局，导致无聊猿大招命中指定角色的技能行为是指向性的，是否影响平衡性？<ul>
<li>A：如果在施放大招前就使用了无敌技能，那么在进入无聊领域时，无聊猿的大招将进入CD状态。作为无聊猿的玩家同样需要承受在无聊领域中接近对方的风险。</li>
</ul>
</li>
<li>Q：因为大招的决策几乎是一次性的，如何处理无聊猿在对错误的目标施放大招后的负反馈（例如将过于强势的英雄带到无聊领域中，导致自己被击杀）？<ul>
<li>A：在无聊领域的关卡设计中，双方出生在同一面片碰撞上，面片中心有镂空障碍，接近彼此需要绕过该镂空障碍。玩家可通过关卡机制带来的躲避、迂回等处理方式，以此来稀释错误决策带来的负反馈。</li>
</ul>
</li>
</ul>
<h2><span id="二-功能需求">二、功能需求</span></h2><h4><span id="21-无聊猿普通技能僵尸">2.1 无聊猿普通技能：僵尸</span></h4><ul>
<li><p>技能定位：变身、无敌</p>
</li>
<li><p>技能描述：</p>
<ul>
<li>无聊猿瞬间转化为僵尸，一段时间内处于完全无敌状态，增加移动速度，无法开火或使用其他技能。</li>
</ul>
</li>
<li><p>技能细节：</p>
<ul>
<li>施放类型：点击施放，可提前点按恢复为常态</li>
<li>技能状态持续时间：待定</li>
<li>技能冷却时间：待定</li>
<li>冷却计算方式：点击施放即开始计算</li>
</ul>
</li>
<li><p>技能操作：</p>
<ul>
<li>技能施放：按下技能键后立即施放</li>
<li>技能停止：技能状态持续时间结束，或再次点击技能按钮结束技能，此时无聊猿变回常态</li>
<li>技能取消：通用技能取消机制</li>
</ul>
</li>
<li><p>其他技能效果</p>
<ul>
<li>期间内完全无敌，消除所有减益效果</li>
<li>使用技能后，弹药立即装填</li>
<li>使用期间可以接受治疗</li>
</ul>
</li>
</ul>
<h4><span id="22-无聊猿大招技能无聊领域">2.2 无聊猿大招技能：无聊领域</span></h4><ul>
<li><p>技能定位：控制、伤害、空间</p>
</li>
<li><p>技能描述：</p>
<ul>
<li>无聊猿引导0.5秒，与距离最近的敌方英雄同时传送至一个半径50的无聊领域，获得10%的额外伤害加成。在此领域内，无聊猿与目标将进行一对一的对决。</li>
</ul>
</li>
<li><p>技能细节：</p>
<ul>
<li>施放类型：点击施放</li>
<li>技能状态持续时间：待定</li>
<li>技能冷却时间：充能，能量满可立即施放；技能状态持续时间内可持续充能，但处于无聊领域内时技能不可施放</li>
</ul>
</li>
<li><p>技能操作：</p>
<ul>
<li>技能施放：按下技能键后立即施放</li>
<li>索敌规则：与自身距离最近的敌方英雄</li>
<li>技能取消：通用技能取消机制</li>
</ul>
</li>
<li><p>空间传送规则：</p>
<ul>
<li>技能状态持续时间结束，我方与被传送的英雄依旧存活，双方英雄传送回原点</li>
<li>技能状态持续时间内，其中一方被击杀，另一方英雄传送回原点</li>
<li>若有多个无聊猿同时施放该技能，均传送到同一空间。</li>
</ul>
</li>
</ul>
<h2><span id="三-美术需求">三、美术需求</span></h2><h4><span id="31-无聊猿普通技能次元裂缝">3.1 无聊猿普通技能：次元裂缝</span></h4><ul>
<li>技能表现（变身参考）</li>
</ul>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hjdbznpttnj30fe07jach.jpg" alt="图片1.png"></p>
<ul>
<li>技能表现（模型参考，左常态，右僵尸态）</li>
</ul>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hjdbz7kflhj30gs0ccdm4.jpg" alt="image-20230804094818533.png"></p>
<table>
<thead>
<tr>
<th align="left">项目</th>
<th>内容</th>
<th align="left">数量</th>
</tr>
</thead>
<tbody><tr>
<td align="left">原画</td>
<td>根据不同皮肤的僵尸</td>
<td align="left">根据皮肤定义</td>
</tr>
<tr>
<td align="left">模型</td>
<td>僵尸模型，施放该技能时，角色表现的模型</td>
<td align="left">根据皮肤定义</td>
</tr>
<tr>
<td align="left">特效</td>
<td>切换为僵尸形态，僵尸形态切换为常态特效</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">动作</td>
<td>变身动作，恢复常态动作</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">动作</td>
<td>僵尸移动动作、僵尸跳跃动作</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">UI</td>
<td>技能按钮图标</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">UI</td>
<td>施放该技能时，僵尸全局半透明蒙版（参考观战界面全局蒙版，用于表达无敌与僵尸化概念）</td>
<td align="left">1</td>
</tr>
</tbody></table>
<h4><span id="32-无聊猿普通技能无聊领域">3.2 无聊猿普通技能：无聊领域</span></h4><table>
<thead>
<tr>
<th align="left">项目</th>
<th>内容</th>
<th align="left">数量</th>
</tr>
</thead>
<tbody><tr>
<td align="left">原画</td>
<td>无聊领域场景概念设计</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">模型</td>
<td>无聊领域场景建模</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">特效</td>
<td>角色拥有增伤加成，附着在模型上的增伤特效</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">特效</td>
<td>角色传送进入无聊领域，与传送离开无聊领域的传送特效</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">动作</td>
<td>施放技能动作</td>
<td align="left">1</td>
</tr>
<tr>
<td align="left">UI</td>
<td>技能按钮图标</td>
<td align="left">1</td>
</tr>
</tbody></table>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/game-design/" rel="tag">game-design</a>
            </div>
        
    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2020/gd_sample_ingame_capture/">
                占领模式战场规则
            </a>
        </h2>
    
    <time>
        2月 21, 2020
    </time>
    <section class="content">
        <h3><span id="更新日志">更新日志</span></h3><table>
<thead>
<tr>
<th>日期</th>
<th>内容</th>
<th align="left">作者</th>
</tr>
</thead>
<tbody><tr>
<td>2023年3月4日</td>
<td>创建文档</td>
<td align="left">朱兴韬</td>
</tr>
<tr>
<td>2023年3月10日</td>
<td>新增占领点HUD描述</td>
<td align="left">朱兴韬</td>
</tr>
<tr>
<td>2023年4月17日</td>
<td>移除平局结算规则</td>
<td align="left">朱兴韬</td>
</tr>
</tbody></table>
<h2><span id="一-设计目的">一、设计目的</span></h2><p>引入新的战场玩法，以增加游戏的多样性，提高竞技趣味，并促进游戏长期玩家留存。</p>
<h2><span id="二-功能概述">二、功能概述</span></h2><p>占领模式的玩法规则规则、功能交互，明确定义占领模式的胜负规则以及玩家的体验流程。</p>
<h2><span id="三-功能规则">三、功能规则</span></h2><h4><span id="31-占领模式玩法规则">3.1 占领模式玩法规则</span></h4><ul>
<li>占领模式中，战场上散布着多个占领点，每个占领点每秒都会产生一定数量的胜利点数。胜利的关键在于，当任意一队的胜利点数首先达到设定值时，该队将获胜。游戏的核心目标是争夺这些占领点，需要不断争夺和保卫以保持领先地位。</li>
</ul>
<h4><span id="32-占领点预制">3.2 占领点预制</span></h4><ul>
<li><p>占领点将采用触发器（Trigger）的预制体，用于在客户端检测触发器范围内的队伍数量，从而实现占领交互。占领区域的大小将由触发器预制体的碰撞范围决定。</p>
</li>
<li><p>占领状态将分为3个状态，一旦变为已占领状态，将无法再次变回中立状态，只能更改占领点的归属方：</p>
<ul>
<li>中立状态（灰色）：初始状态，不产生胜利点数。</li>
<li>我方状态（蓝色）：已占领，产生胜利点数，计入我方队伍。</li>
<li>敌方状态（红色）：已占领，产生胜利点数，计入敌方队伍。</li>
</ul>
</li>
<li><p>占领规则包括以下情况：</p>
<ul>
<li><p>中立状态下：</p>
<ul>
<li>场景1：当占领区域内只有1个队伍时，开始占领。占领时间应从触发器的<code>captureTime</code>字段读取（单位：毫秒）。占领时间结束后，占领点的归属将变为触发占领时间的队伍（不属于该队伍的占领点才会触发<code>captureTime</code>的计算）。</li>
<li>在占领过程中，如果占领点内的队伍之一离开该区域，则该队伍的<code>captureTime</code>将逐渐重置为0。</li>
<li>场景2：如果占领过程中，占领区域内有其他队伍进入，占领将暂停。占领时间会继续计算，但只有占领点内只有1个队伍时，占领时间才能继续计算。</li>
<li>场景3：如果A队伍占领一个点，B队伍进入该区域并驱逐A队伍，需要等待已经计算的<code>captureTime</code>逐渐重置为0，才能再次触发<code>captureTime</code>。<ul>
<li>如果在此过程中，A队伍重新进入占领区域，清零过程将暂停。此时，A队伍将B队伍的玩家驱逐出占领点，清零的<code>captureTime</code>会逐渐回满。</li>
</ul>
</li>
</ul>
</li>
<li><p>已占领状态下：</p>
<ul>
<li>场景1：当占领区域内没有我方玩家，敌对玩家进入占领区域，开始占领。占领时间将从触发器的<code>captureTime</code>字段读取（以毫秒为单位）。占领时间结束后，占领点的归属将变为触发占领时间的队伍（不属于该队伍的占领点才会触发<code>captureTime</code>的计算）。</li>
<li>场景2：占领过程中，占领区域内有其他队伍进入，占领将暂停。只有在占领点内只有敌对队伍时，占领时间才会继续计算。</li>
<li>场景3：占领过程中，如果敌对队伍的玩家被驱逐出占领区域，已经计算的<code>captureTime</code>将逐渐重置为0。<ul>
<li>如果在清零期间，敌对队伍重新进入占领区域，清零进程将暂停。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>占领点会根据占领预制体的<code>getPointPerSecond</code>字段，每秒为占领点的归属方增加胜利点数。每秒都会计算每支队伍拥有的占领点，从而决定胜利点数。</p>
</li>
<li><p>占领点的UI样式将包括以下元素：</p>
<ul>
<li>占领点名称：通过<code>name#string</code>字段配置，用于在UI中显示，只允许填写大写英文字母A-Z。</li>
<li>占领点图标样式：在预制体内提供下拉选项，包括L/S/M，用于控制占领点图标的UI位置。</li>
</ul>
</li>
</ul>
<h4><span id="33-胜负与结算规则">3.3 胜负与结算规则</span></h4><p>触发结算条件：</p>
<ol>
<li>战场时间限制（<code>roundTime#float</code>）内，任何一方率先达到<code>occupyWinPoint#int</code>的胜利点数，即可获胜。<ul>
<li>胜利方：达到胜利点数的一方将获胜。</li>
<li>失败方：结算时拥有的胜利点数较少的一方将失败。</li>
</ul>
</li>
<li>如果在战场的时间限制（<code>roundTime#float</code>）内，没有任何一方达到胜利点数，比赛将在时间结束后进行结算。<ul>
<li>胜利方：在结算时拥有胜利点数更多的一方将获胜。</li>
<li>失败方：在结算时拥有胜利点数较少的一方将失败。</li>
</ul>
</li>
</ol>
<h4><span id="34-占领模式配置">3.4 占领模式配置</span></h4><ul>
<li><p>占领点预制将包括以下字段以支持功能实现：</p>
<table>
<thead>
<tr>
<th>字段名</th>
<th>类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>captureTime</td>
<td>int</td>
<td>占领时间（毫秒）</td>
</tr>
<tr>
<td>getPointPerSecond</td>
<td>int</td>
<td>每秒获得的胜利点数</td>
</tr>
<tr>
<td>pic</td>
<td>string</td>
<td>占领点图片路径（数组，每个状态有3张图）</td>
</tr>
</tbody></table>
</li>
<li><p>客户端战局配置：</p>
<ul>
<li>引入占领模式配置表：<code>capture_target_cfg</code>，用于配置占领模式的相关信息。</li>
<li>以下是新增字段：</li>
</ul>
<table>
<thead>
<tr>
<th align="left">字段名</th>
<th>类型</th>
<th>描述</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td align="left">occupyWinPoint</td>
<td>int</td>
<td>胜利点数</td>
<td>新增字段</td>
</tr>
<tr>
<td align="left">occupyPointFx</td>
<td>string</td>
<td>胜利点数增长特效，配置数组，大于等于该分数展示的特效</td>
<td>新增字段</td>
</tr>
<tr>
<td align="left">roundTime</td>
<td>float</td>
<td>比赛时长</td>
<td>复用</td>
</tr>
<tr>
<td align="left">noticeSelfTeamScoreHalf</td>
<td>int</td>
<td>通知-我方获胜进度已过半<br>我方拥有胜利点数大于等于occupyWinPoint/2时</td>
<td>规则变更</td>
</tr>
<tr>
<td align="left">noticeEnemyTeamSocreHalf</td>
<td>int</td>
<td>通知-敌方获胜进度已过半<br>对方拥有胜利点数大于等于occupyWinPoint/2时</td>
<td>规则变更</td>
</tr>
<tr>
<td align="left">noticeWinRemain</td>
<td>int</td>
<td>通知-再击败{0}名敌人即可获胜 <strong>–&gt;</strong> 通知-再获得{0}分数即可获胜</td>
<td>规则变更</td>
</tr>
<tr>
<td align="left">occupyWeaponDelTime</td>
<td>int</td>
<td>占领模式武器掉落消失时间</td>
<td>新增字段</td>
</tr>
<tr>
<td align="left">occupyResurgenceType</td>
<td>int</td>
<td>占领模式死亡后复活方式</td>
<td>新增字段</td>
</tr>
<tr>
<td align="left">occupyResurgenceTime</td>
<td>int</td>
<td>占领模式复活等待时间</td>
<td>新增字段</td>
</tr>
<tr>
<td align="left">occupyResurgenceBuff</td>
<td>int</td>
<td>占领模式复活时添加buffId</td>
<td>新增字段</td>
</tr>
</tbody></table>
</li>
<li><p>战服与平台配置：</p>
<ul>
<li>新增<code>gameId=5000</code>，表示占领玩法规则</li>
<li>新增<code>gameType=600</code>，表示占领游戏类型</li>
</ul>
</li>
</ul>
<h4><span id="35-占领模式交互表现">3.5 占领模式交互表现</span></h4><ul>
<li><p>不同状态的占领点样式</p>
<ul>
<li><p>我方点位：蓝色：</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hish358y8mj31hc0r14qp.jpg" alt="image.png"></p>
</li>
<li><p>敌方点位：红色：</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hisgy3g2hyj31hc0rab29.jpg" alt="image.png"></p>
</li>
<li><p>中立点位：灰色：</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hisgrsg91vj31hc0rmb29.jpg" alt="image.png">点位进度条：根据不同队伍触发的<code>captureTime</code>，展示进度条，绕占领点底一周展示。</p>
</li>
</ul>
</li>
<li><p>模式UI：需要展示以下内容。</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hish8s0lr2j30o5070wiw.jpg" alt="image.png"></p>
<ul>
<li><p>A 分数情况：分别展示两队的当前分数，需展示进度条与具体数值。</p>
</li>
<li><p>B 占领点情况：地图内所有点位的占领情况（我方归属、敌方归属、中立）。</p>
<ul>
<li>占领点图标根据占领点预制的pic字段展示。</li>
</ul>
</li>
<li><p>C 胜利点增加情况：每秒有跳字效果，根据当前不同的加分值展示不同特效，根据模式配置表的<code>occupyPointFx</code>字段索引特效。</p>
</li>
<li><p>占领过程：我方captureTime触发时，若角色在该占领区域内，则展示正在占领UI。</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hishboqdf4j30nt0azjx7.jpg" alt="image.png"></p>
</li>
<li><p>占领点HUD界面：占领点上方需根据预制内的Pic配置，展示对应的HUD界面，实现方式参照血条。</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hishcqkp9rj30ha0cv79m.jpg" alt="image.png"></p>
<ul>
<li>显示层级：该HUD在场景中穿透墙壁，但会被任意Caster遮挡。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4><span id="35-占领模式交互表现">3.5 占领模式交互表现</span></h4><h2><span id="四-美术需求">四、美术需求</span></h2><h4><span id="41-美术需求清单">4.1 美术需求清单</span></h4><table>
<thead>
<tr>
<th>名称</th>
<th align="left">需求类型</th>
<th>描述图片</th>
</tr>
</thead>
<tbody><tr>
<td>占领点模式UI：包含进度条、占领图标（我方归属、敌方归属、中立）；图标大小需设计3个级别（使用边框区分），用于区分不同占领点的重要程度；当前点位的摆放方式也需要设计：小x2、中x1、大x1<br><strong>占领点图标内部根据地图场景，设计贴合地图场景的剪影</strong></td>
<td align="left">UI</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1hish8s0lr2j30o5070wiw.jpg" alt="image.png"></td>
</tr>
<tr>
<td>占领进程进度条UI</td>
<td align="left">UI</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1hish8s0lr2j30o5070wiw.jpg" alt="image.png"></td>
</tr>
<tr>
<td>占领点HUD</td>
<td align="left">UI</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1hishcqkp9rj30ha0cv79m.jpg" alt="image.png"></td>
</tr>
<tr>
<td>占领点地板贴图</td>
<td align="left">模型贴图</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1hishboqdf4j30nt0azjx7.jpg" alt="image.png"></td>
</tr>
<tr>
<td>归属权更换场景特效</td>
<td align="left">特效</td>
<td>由占领点中心向占领点四周播放白色波纹</td>
</tr>
<tr>
<td>占领进度条特效：缓慢流动光效</td>
<td align="left">特效</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1hish358y8mj31hc0r14qp.jpg" alt="image.png"></td>
</tr>
</tbody></table>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/game-design/" rel="tag">game-design</a>
            </div>
        
    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2020/gd_sample_ingame_recoil/">
                枪械后坐力规则
            </a>
        </h2>
    
    <time>
        2月 21, 2020
    </time>
    <section class="content">
        <h3><span id="更新日志">更新日志</span></h3><table>
<thead>
<tr>
<th>日期</th>
<th>内容</th>
<th align="left">作者</th>
</tr>
</thead>
<tbody><tr>
<td>2022年12月12日</td>
<td>调用震屏控制相机前后与左右旋转</td>
<td align="left">朱兴韬</td>
</tr>
<tr>
<td>2022年12月6日</td>
<td>新增准星强制回准与触发镜头移动跳出回准需求</td>
<td align="left">朱兴韬</td>
</tr>
<tr>
<td>2022年12月5日</td>
<td>新增每1次射击后坐力镜头运动曲线，与准星回位镜头运动曲线需求</td>
<td align="left">朱兴韬</td>
</tr>
<tr>
<td>2022年11月28日</td>
<td>修改系统案，更改后坐力实现方式</td>
<td align="left">朱兴韬</td>
</tr>
<tr>
<td>2022年11月25日</td>
<td>创建文档</td>
<td align="left">朱兴韬</td>
</tr>
</tbody></table>
<h2><span id="一-设计目的">一、设计目的</span></h2><p>新增枪械的后坐力机制，强化射击手感，增加枪械策略性与射击趣味性</p>
<h2><span id="二-流程图">二、流程图</span></h2><p><img src="https://fc.sinaimg.cn/large/00724HnBly1hitnyb374dj30pd0h7jte.jpg" alt="后坐力计算机制流程图_221128_v2.0-16696246979671.png"></p>
<h2><span id="三-概述">三、概述</span></h2><ul>
<li>枪械现在在射击时，会附带后坐力，后坐力表现区别于现有的震屏功能。本文中将对后坐力的触发方式、触发表现进行规范与细化。</li>
</ul>
<h2><span id="四-配置表">四、配置表</span></h2><h4><span id="41-新增字段">4.1 新增字段</span></h4><p>在枪械预制中新增以下配置</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th align="left">内容</th>
</tr>
</thead>
<tbody><tr>
<td>recoilGapTime</td>
<td>int</td>
<td align="left">停火间隔；配置毫秒</td>
</tr>
<tr>
<td>recoilMoveBackTime</td>
<td>int</td>
<td align="left">回位时间；配置毫秒</td>
</tr>
<tr>
<td>isForceMoveBack</td>
<td>bool</td>
<td align="left">TRUE= 强制回准 <br>FALSE= 如果玩家通过滑屏激活了aimingCamera，则不进行回准</td>
</tr>
</tbody></table>
<h2><span id="四-功能规则">四、功能规则</span></h2><h4><span id="41-后坐力计算">4.1 后坐力计算</span></h4><ul>
<li><p>后坐力信息读取：枪械预制中新增后坐力脚本。</p>
<ul>
<li><p>读取脚本中配置后坐力信息，后坐力信息中枚举了在“连续射击”状态内，每1次射击的镜头偏移量。每1次连续射击的重新触发，都需要从后坐力信息的第1个条目进行重新读取。</p>
<table>
<thead>
<tr>
<th>KEY（开火次数）</th>
<th>X</th>
<th>Y</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>3</td>
<td>0.2</td>
<td>0</td>
<td>表示从第0枪~第3枪，每次射击镜头绕X轴移动0.2个单位。</td>
</tr>
<tr>
<td>10</td>
<td>0.15</td>
<td>0.2</td>
<td>表示从第4枪~第10枪，每次射击镜头绕X轴移动0.5个单位，绕Y轴移动0.2个单位。</td>
</tr>
<tr>
<td>18</td>
<td>0</td>
<td>-0.2</td>
<td>表示从第11枪~第18枪，每次射击镜头绕Y轴移动-0.2个单位，18枪之后若无配置，则按照第18枪的配置信息执行偏移，直至子弹耗尽。</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>连续射击的失效</p>
<ul>
<li>当两次射击间隔<code>≥recoilGapTime</code>配置的时间，武器被视为停火，下次射击重新计算后坐力。</li>
</ul>
</li>
</ul>
<h4><span id="42-后坐力表现">4.2 后坐力表现</span></h4><ul>
<li><p>新增后坐力运动表现：枪械预制中新增后坐力曲线脚本，用于控制每次射击镜头偏移的运动曲线，调用Unity的Curve组件实现。</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hitmsa6pa5j30ks0l10v7.jpg" alt="image.png"></p>
<ul>
<li>X轴表示后坐力表现时长，一般配置为枪械的射击间隔；Y轴为偏移量表现速度。</li>
<li>图示，若图内枪械为“霰弹枪”的后坐力镜头表现，根据该曲线，则表现为：<ul>
<li>射击后，枪械在0.05s内会迅速播放偏移量的95%，剩余5%部分在0.05s内表现完成。霰弹枪短时间快速抬高，滞空，进入回准表现。</li>
</ul>
</li>
</ul>
</li>
<li><p>镜头偏移坐标：</p>
<ul>
<li>绕X轴的偏移：根据prefab配置镜头像素偏移，该偏移量可累计。<ul>
<li>0=不偏移；负整数=向下偏移；正整数=向上偏移。</li>
</ul>
</li>
<li>绕Y轴的偏移：根据prefab配置进行准星像素偏移，该偏移量可累计。<ul>
<li>0=不偏移；负整数=向左偏移；正整数=向右偏移。</li>
</ul>
</li>
<li>偏移时长：根据后坐力脚本配置时长，控制准星完成该次偏移所需要的时间，该时间可累计。<ul>
<li>配置毫秒。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4><span id="43-准星回位">4.3 准星回位</span></h4><ul>
<li>准星回位触发条件：两次射击间隔<code>≥recoilGapTime</code>配置的时间，开始进行准星回位流程。</li>
<li>准星回位方式：计算玩家在射击或连续射击期间获得的所有Y轴与X轴偏移量，根据该偏移量，移动准星进行回位。<ul>
<li>回位的持续时间：根据<code>recoilMoveBackTime</code>的配置时长，控制准星从当前位置移动到回位位置所需的时间。</li>
<li>新增回位运动表现：在每一把枪械预制中新增参数（同4.2 后坐力表现），用于控制每次回位准星偏移的运动曲线。</li>
</ul>
</li>
<li>新增bool类型字段：<code>isForceMoveBack</code><ul>
<li>TRUE= 强制回准。</li>
<li>FALSE= 如果玩家通过滑屏激活了aimingCamera，则不进行回准。</li>
</ul>
</li>
</ul>
<h4><span id="44-震屏功能">4.4 震屏功能</span></h4><ul>
<li>现在在射击时，调用现有的CameraShake功能，每一次射击，震屏表现的持续时间与后坐力表现时长相等。</li>
<li>枪械预制中可加载震屏文件。</li>
</ul>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/game-design/" rel="tag">game-design</a>
            </div>
        
    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2020/gd_sample_ingame_party_point/">
                局内派对点奖励规则
            </a>
        </h2>
    
    <time>
        2月 20, 2020
    </time>
    <section class="content">
        <h2><span id="更新日志">更新日志</span></h2><table>
<thead>
<tr>
<th>日期</th>
<th>内容</th>
<th align="left">作者</th>
</tr>
</thead>
<tbody><tr>
<td>2023年8月14日</td>
<td>创建文档</td>
<td align="left">朱兴韬</td>
</tr>
<tr>
<td>2023年10月8日</td>
<td>明确派对点校验规则<br>明确BOSS死亡后，OGX使用卡牌的派对点去向</td>
<td align="left">朱兴韬</td>
</tr>
</tbody></table>
<h2><span id="一-设计目的">一、设计目的</span></h2><p>玩家可以通过在游戏中获取派对点，增加游戏的趣味性和奖励；这个功能的目标是让玩家在游戏中的行为有正向奖励反馈，同时也为OGX在游戏内使用卡牌技能提供正当性。</p>
<h2><span id="二-功能概述">二、功能概述</span></h2><ul>
<li>此规则主要围绕派对点的产出、掉落交互、奖池、奖池表现及派对点的局内掉落方式进行设计。</li>
<li>OGX玩家在游戏中使用技能卡牌将消耗派对点，这些派对点将通过各种方式返回给普通玩家。<ul>
<li>玩家通过开启宝箱、击杀NPC等枚举行为可获得派对点。</li>
<li>玩家一旦成功撤离，将根据场上玩家存活的数量，从撤离奖励池获得派对点。</li>
</ul>
</li>
</ul>
<h2><span id="三-流程示意图">三、流程示意图</span></h2><h3><span id="31-完整流程">3.1 完整流程</span></h3><p><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xghw2uj30ox0y2n11.jpg" alt="image-20230915140853929.png"></p>
<h3><span id="32-抽奖流程">3.2 抽奖流程</span></h3><p><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xghx4tj30ph11djvd.jpg" alt="image-20230918111733363.png"></p>
<h2><span id="四-新增配置">四、新增配置</span></h2><h3><span id="41-party_point_action_cfg">4.1 <code>party_point_action_cfg</code></span></h3><ul>
<li>新增配置表<code>party_point_action_cfg</code>，用于配置玩家获得派对点奖励的不同行为。</li>
</ul>
<p>[TABLE_BEGIN]</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>字段名</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id#string</td>
<td>行为id</td>
<td></td>
</tr>
<tr>
<td>completedAction#int</td>
<td>玩家完成行为枚举</td>
<td>根据枚举类型读取actionValue字段读取参数<br>100=开启宝箱，读取宝箱id<br>200=击杀指定NPC，读取npc的id</td>
</tr>
<tr>
<td>actionValue#int</td>
<td>行为参数</td>
<td></td>
</tr>
<tr>
<td>actionPro</td>
<td>完成该枚举增加的概率</td>
<td></td>
</tr>
</tbody></table>
<p>[TABLE_END]</p>
<h3><span id="42-party_point_reward_cfg">4.2 <code>party_point_reward_cfg</code></span></h3><ul>
<li>新增配置表<code>party_point_reward_cfg</code>，用于配置玩家获得的派对点奖励。</li>
</ul>
<p>[CONFIG_BEGIN]</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>字段名</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>jackpotPercent#int</td>
<td>配置进入奖池的派对币百分比</td>
<td></td>
</tr>
<tr>
<td>loseAddPro#string</td>
<td>每次抽奖失败增加保底概率</td>
<td>配置对象<br>第一个数为失败次数<br>第二个数为增加的概率</td>
</tr>
<tr>
<td>onceWinEmptyTimes#int</td>
<td>中奖一次轮空次数</td>
<td></td>
</tr>
</tbody></table>
<p>[CONFIG_END]</p>
<p>[TABLE_BEGIN]</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>字段名</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>id#int</td>
<td>奖励id</td>
<td></td>
</tr>
<tr>
<td>partyPointReward#int</td>
<td>获得的派对点</td>
<td>获得当前奖池内千分比</td>
</tr>
<tr>
<td>pro</td>
<td>档位权重</td>
<td>千分比</td>
</tr>
<tr>
<td>noticeId#int</td>
<td>通知id</td>
<td>获得该奖励时的全局播报，配空则不触发播报</td>
</tr>
</tbody></table>
<p>[TABLE_END]</p>
<h4><span id="421-配置示例">4.2.1 配置示例</span></h4><p><code>party_point_reward_cfg</code><br><code>[</code><br>  <code>[</code><br>    <code>&#123;</code><br>      <code>&quot;jackpotPercent&quot;: 500,</code><br>      <code>&quot;loseAddPro&quot;: &quot;&#123;3:1500,5:3000&#125;&quot;,</code><br>      <code>&quot;onceWinEmptyTimes&quot;: 5</code><br>    <code>&#125;</code><br>  <code>],</code><br>  <code>[</code><br>    <code>&#123;</code><br>      <code>&quot;id&quot;: 1,</code><br>      <code>&quot;partyPointReward&quot;: 90,</code><br>      <code>&quot;pro&quot;: &quot;1000&quot;,</code><br>      <code>&quot;noticeId&quot;: 500011</code><br>    <code>&#125;,</code><br>    <code>&#123;</code><br>      <code>&quot;id&quot;: 2,</code><br>      <code>&quot;partyPointReward&quot;: 80,</code><br>      <code>&quot;pro&quot;: &quot;800&quot;,</code><br>      <code>&quot;noticeId&quot;: 500011</code><br>    <code>&#125;,</code><br>    <code>&#123;</code><br>      <code>&quot;id&quot;: 3,</code><br>      <code>&quot;partyPointReward&quot;: 70,</code><br>      <code>&quot;pro&quot;: &quot;600&quot;,</code><br>      <code>&quot;noticeId&quot;: 500011</code><br>    <code>&#125;,</code><br>    <code>&#123;</code><br>      <code>&quot;id&quot;: 4,</code><br>      <code>&quot;partyPointReward&quot;: 60,</code><br>      <code>&quot;pro&quot;: &quot;400&quot;,</code><br>      <code>&quot;noticeId&quot;: 500011</code><br>    <code>&#125;,</code><br>    <code>&#123;</code><br>      <code>&quot;id&quot;: 5,</code><br>      <code>&quot;partyPointReward&quot;: 50,</code><br>      <code>&quot;pro&quot;: &quot;200&quot;,</code><br>      <code>&quot;noticeId&quot;: 500011</code><br>    <code>&#125;</code><br>  <code>]</code><br><code>]</code></p>
<h2><span id="五-功能规则">五、功能规则</span></h2><h3><span id="51-功能开关">5.1 功能开关</span></h3><ul>
<li>判断当前匹配对局内是否有OGX玩家或AI上帝。<ul>
<li>如果有OGX玩家或AI上帝：启用派对点奖励规则。</li>
<li>如果没有OGX玩家或AI上帝：禁用派对点奖励规则。</li>
</ul>
</li>
</ul>
<h3><span id="52-派对点产出">5.2 派对点产出</span></h3><ul>
<li>局内目前有奖池设计，OGX玩家在局内消耗的所有派对点都将进入奖池，产出派对点的方式与来源请查看系统案：<a target="_blank" rel="noopener" href="http://doc.easegame/pgproject/designerdoc/-/wikis/%E6%96%B0%E4%B8%BB%E7%8E%A9%E6%B3%95%E6%88%98%E6%96%97%E7%9B%B8%E5%85%B3/W-%E7%8E%A9%E6%B3%95%E6%A8%A1%E5%BC%8F/OB%E6%A8%A1%E5%BC%8F%E7%B3%BB%E7%BB%9F%E5%8A%9F%E8%83%BD/O-OB%E5%8D%A1%E7%89%8C%E5%8A%9F%E8%83%BD">O OB卡牌功能 </a>。<ul>
<li>消耗派对点的途径包括：使用卡牌，读取<code>ob_card_cfg</code>配置表的<code>bonus</code>字段进行产出。</li>
<li>BOSS一旦死亡，OGX玩家消耗的派对点，不进行任何处理。</li>
</ul>
</li>
<li>派对点校验：在结算过程中，玩家获得的派对点，不允许大于OGX在局内消耗的派对点，若结算时检测到该情况，则没收玩家所有派对点。</li>
</ul>
<h3><span id="53-派对点分配">5.3 派对点分配</span></h3><ul>
<li>OGX产出的派对点，一部分进入“派对点奖池”，另一部分进入“撤离奖励池”，分配方式如下：<ul>
<li>派对点奖池：OGX产出派对点 * <code>jackpotPercent</code>字段，得出的派对点进入派对点奖池。</li>
<li>撤离奖励池：剩余派对点，计入撤离奖励池。</li>
</ul>
</li>
</ul>
<h3><span id="54-撤离奖励池">5.4 撤离奖励池</span></h3><ul>
<li>OGX附身的BOSS死亡时，将“派对点奖池”内的所有派对点，计入“撤离奖励池”，派对点奖池不复存在。此后OGX玩家花费的派对点也计入“撤离奖励池”。</li>
<li>该奖励不会立即获得，只有成功撤离，进入结算流程的玩家，才可获得从撤离奖励池中分得奖励，具体表现查看系统案：<a target="_blank" rel="noopener" href="http://doc.easegame/pgproject/designerdoc/-/wikis/%E6%96%B0%E4%B8%BB%E7%8E%A9%E6%B3%95%E6%88%98%E6%96%97%E7%9B%B8%E5%85%B3/W-%E7%8E%A9%E6%B3%95%E6%A8%A1%E5%BC%8F/D-%E5%A4%BA%E9%87%91%E6%A8%A1%E5%BC%8F/D-%E5%A4%BA%E9%87%91%E6%A8%A1%E5%BC%8F-%E6%88%98%E6%96%97%E7%BB%93%E7%AE%97">D 夺金模式 战斗结算</a>。<ul>
<li>在BOSS死亡时，系统将记录击杀BOSS的队伍与队伍情况，供结算使用。</li>
<li>若为是，则将 撤离奖励池中的派对点数量 / 击杀BOSS时队内存活的玩家数量 = 玩家获得的撤离派对点奖励。玩家获得派对点奖励后，将所获得的派对点从“撤离奖励池”中扣除。</li>
</ul>
</li>
</ul>
<h3><span id="55-派对点奖池">5.5 派对点奖池</span></h3><ul>
<li><p>奖池抽取条件：当玩家完成指定的枚举行为时，有可能在派对点奖池中完成一次抽取，枚举行为根据<code>party_point_action_cfg</code>配置表的<code>completedAction</code>字段读取，具体如下：</p>
<ul>
<li><code>100</code>=开启宝箱，读取<code>actionValue</code>的宝箱id。关于夺金模式内开启宝箱的具体规则，查看系统案：夺金模式宝箱规则。</li>
<li><code>200</code>=击杀指定NPC，读取<code>actionValue</code>的NPC的id。关于夺金模式内击杀NPC的具体规则，查看系统案：NPC系统。</li>
</ul>
</li>
<li><p>奖池抽取概率：能否进行1次抽奖，是由 行为概率 与 保底概率 相加决定的。</p>
<ul>
<li>完成指定行为后，可根据<code>party_point_action_cfg</code>中所完成行为的<code>actionPro</code>字段，获得行为概率。</li>
<li>若某次抽奖失败，失败次数+1，失败次数可累加；每次抽奖时根据<code>party_point_reward_cfg</code>的<code>loseAddPro</code>字段增加抽奖保底概率。<ul>
<li><code>loseAddPro</code>为对象字段，第一个数配置失败次数，第二个数配置增加的概率。抽奖失败次数≥第一个数时，读取该数组的第二个数增加保底概率，失败次数只会判断对象中最大的失败次数值生效。</li>
<li>玩家成功获得1次抽奖资格后，失败次数清零。</li>
</ul>
</li>
</ul>
</li>
<li><p>奖池轮空：成功进行1次抽取后，玩家的任何行为都不再触发抽奖以及失败次数  ，直到玩家完成的行为次数大于等于<code>onceWinEmptyTimes</code>字段值。</p>
</li>
<li><p>奖池抽取：玩家获得抽取资格后，进入<code>party_point_reward_cfg</code>进行抽取，具体规则如下：</p>
<ul>
<li>读取各个奖励id的千分比<code>pro</code>字段，随机出玩家所获得的奖励。</li>
<li>最终获得的奖励根据随机到奖励实例的<code>partyPointReward</code>字段进行配置，该字段配置值为千分比。<ul>
<li>当前奖池的派对点总额 * <code>partyPointReward</code>字段值，为玩家最终获得的奖励。</li>
</ul>
</li>
<li>玩家获得奖励后，需将获得的派对点从奖池中扣除。<ul>
<li>从奖池内获得的派对点，保底为1。</li>
<li>若当前奖池派对点总额为0，则玩家抽取后不会获得任何奖励。</li>
</ul>
</li>
</ul>
</li>
<li><p>玩家从派对点奖池获得的派对点奖励，视为玩家在局内所携带的物品，玩家一旦死亡，其携带的派对点将会作为物品掉落，供其他玩家拾取。</p>
</li>
</ul>
<h4><span id="551-派对点奖池常态交互">5.5.1 派对点奖池：常态交互</span></h4><ul>
<li><p>当前奖池内派对点的总数量如下图所示，该界面表现为功能常态。</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xh1cdfj30yh0jhnas.jpg" alt="image-20230817113418157.png"></p>
<ul>
<li>展示派对点图标、当前奖池内的派对点总额。</li>
<li>每当OGX玩家消耗派对点时，经过分配的派对点，会在派对点总额后方，以加号附带白色数字方式进行动效展示，在动效播放完成后，派对点总额数值应有当前值到目标值的逐步数字跳动表现。<ul>
<li>派对点来源展示：派对点增加时，需附带派对点来源信息（OGX使用了什么卡牌导致的奖池派对点增长），如图所示。</li>
<li>卡牌图标读取<code>ob_card_cfg</code>配置表的<code>icon</code>字段。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4><span id="552-派对点奖池奖池抽取">5.5.2 派对点奖池：奖池抽取</span></h4><ul>
<li><p>当玩家完成了指定行为，获得派对点时，该界面播放奖池抽取表现。</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xgvzwsj30vy0htn80.jpg" alt="image-20230815155234198.png"></p>
<ul>
<li>组件内出现3个老虎机形式的滚动数字框，框内数字快速跳动，相关的数字停止逻辑如下<ul>
<li>若服务端下发的奖励id中<code>partyPointReward</code>值为A，则数字有可能表现为：A + A + A 或 A + B + A 或 B + A + A ，三种数字停止逻辑中随机一种进行表现。</li>
<li>数字应该由左至右逐个停止，每个停止时间为0.7秒。</li>
<li>B的数值随机在<code>party_point_reward_cfg</code>配置表中取与玩家所获得奖励相同的<code>actionId</code>的<code>partyPointReward</code>进行展示。</li>
</ul>
</li>
<li>数字停止后，玩家获得派对点奖励，播放奖励获得表现。</li>
</ul>
</li>
</ul>
<h4><span id="553-派对点奖池奖励获得">5.5.3 派对点奖池：奖励获得</span></h4><ul>
<li><p>当玩家获得了派对点奖励，抽取表现播放完成，应播放奖励获得表现。</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xh28pkj30vy0hwk2q.jpg" alt="image-20230815161138019.png"></p>
<ul>
<li>展示派对点图标、先展示所获得的百分比，随后百分比数字会变化为根据百分比换算的具体派对点数。</li>
<li>派对点图标从组件中飞出，目标点为背包图标的UI位置，图中“+999”在过程中变为0，同时播放逐步数字跳动表现。<ul>
<li>派对点以道具形式进入背包，若此时背包已满，则掉落在场景中。</li>
</ul>
</li>
<li>该表现播放完成后，该界面组件恢复为常态；若当前还有未展示完成的奖励，则恢复为”奖池抽取”态继续播放表现。</li>
</ul>
</li>
</ul>
<h4><span id="554-派对点奖池通知相关">5.5.4 派对点奖池：通知相关</span></h4><ul>
<li>奖池通知：获得一个派对点奖励时，该奖励ID中的<code>noticeId</code>有配置值时，则去<code>tips_cfg</code>读取通知信息，进行全局广播。<ul>
<li>该奖励的格式应该为：“{0}掠夺了派对奖池，获得了{1}派对点数！”<ul>
<li>{0} = 玩家昵称</li>
<li>{1} = 所获得的派对点数</li>
</ul>
</li>
</ul>
</li>
<li>BOSS死亡通知：OGX附身的BOSS一旦死亡，则去<code>tips_cfg</code>读取通知信息id为<code>ogx_dead_info</code>的字段，进行全局广播。<ul>
<li>该通知的格式应该为：“BOSS已经死亡，击杀的队伍总计获得{0}派对点！”<ul>
<li>{0} = 当前撤离奖池中的派对点数</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4><span id="555-派对点奖池奖池消失表现">5.5.5 派对点奖池：奖池消失表现</span></h4><ul>
<li><p>OGX附身的国王死亡时，将“派对点奖池”内的所有派对点，计入“撤离奖励池”；此时派对点奖池的UI组件应做消失表现。</p>
<p>​        <img src="https://fc.sinaimg.cn/large/00724HnBly1his9xgft9hj30e104h3zy.jpg" alt="image-20230818182615387.png"></p>
<ul>
<li>先播放碎裂特效，碎裂特效播放完成后，UI消失。</li>
</ul>
</li>
</ul>
<h2><span id="六-美术需求">六、美术需求</span></h2><table>
<thead>
<tr>
<th>名称</th>
<th>数量</th>
<th>备注</th>
<th>参考链接</th>
</tr>
</thead>
<tbody><tr>
<td>派对点奖池界面设计</td>
<td>1</td>
<td>包含以下子标题中涉及到的界面需求与动效需求<br>5.5.1 派对点奖池：常态交互<br>5.5.2 派对点奖池：奖池抽取<br>5.5.3 派对点奖池：奖励获得</td>
<td></td>
</tr>
<tr>
<td>奖池老虎机特效</td>
<td>1</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xgvzwsj30vy0htn80.jpg" alt="image-20230815155234198.png"></td>
<td><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1iK411L7wr/">无主之地3老虎机</a><br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1px411s7f5/?spm_id_from=333.337.search-card.all.click&vd_source=7e779790a51b463b45d8444f81a6b1aa">无主之地2老虎机</a></td>
</tr>
<tr>
<td>奖池UI碎裂特效</td>
<td>1</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xgft9hj30e104h3zy.jpg" alt="image-20230818182615387.png"></td>
<td></td>
</tr>
<tr>
<td>奖励获得派对点飞行特效</td>
<td>1</td>
<td><img src="https://fc.sinaimg.cn/large/00724HnBly1his9xh28pkj30vy0hwk2q.jpg" alt="image-20230815161138019.png"></td>
<td><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1BY4y1h7qm">https://www.bilibili.com/video/BV1BY4y1h7qm</a><br>10秒~14秒</td>
</tr>
</tbody></table>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/game-design/" rel="tag">game-design</a>
            </div>
        
    </section>
</article>
  
    <article class="post ">

    
        <h2 class="title">
            <a href="/2020/gd_sample_system_battlepass/">
                战令通行证功能
            </a>
        </h2>
    
    <time>
        2月 19, 2020
    </time>
    <section class="content">
        <p><strong>更新日期：2020-8-26</strong></p>
<p><strong>Version 1.00                                      last saved by：朱兴韬</strong></p>
<p><strong>创建文档</strong></p>
<h2><span id="1-设计目的">1. 设计目的</span></h2><p>优化战令功能交互，重构战令任务系统，强化功能可玩性。</p>
<h2><span id="2-流程图">2. 流程图</span></h2><p><img src="https://fc.sinaimg.cn/large/00724HnBly1hislo7tql0j30nr13ktce.jpg" alt="image.png"></p>
<h2><span id="3-功能简述">3. 功能简述</span></h2><ul>
<li><p>将战令任务拆分为龙宠条件与模式条件，在任务链中抓取了对应任务后，服务端需对其赋予龙宠条件与模式条件限制。</p>
</li>
<li><p> 重构后战令任务实例的组成变为：龙宠/模式（选其一）限制条件+任务条件+完成条件；战令购买条件+龙宠/模式（选其一）限制条件+任务条件+完成条件。</p>
</li>
<li><p>平台简述：</p>
<ul>
<li><p><code>ruleType=4</code>，<code>resetRule=2</code>时，表示该任务实例为战令每日任务</p>
</li>
<li><p><code>ruleType=4</code>，<code>resetRule=3</code>时，表示该任务实例为战令赛季任务（常规任务）</p>
</li>
<li><p> <code>ruleType=5</code>，<code>resetRule=3</code>时，表示该任务实例为战令赛季任务（需购买战令才可进行并完成）</p>
</li>
</ul>
</li>
</ul>
<h2><span id="4-具体设计">4. 具体设计</span></h2><h3><span id="41-平台相关">4.1 平台相关</span></h3><h4><span id="411-新增任务链选取规则与字段">4.1.1 新增任务链选取规则与字段</span></h4><ul>
<li>在<code>task_base</code>中新增以下字段，用于控制战令任务规则，当<code>ruleType=4/5</code>时，成功读取<code>chainId</code>后，进入该字段进行任务链处理。</li>
</ul>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>释义</th>
</tr>
</thead>
<tbody><tr>
<td>battlePassPetLimit</td>
<td>Int</td>
<td>0=不进行限制  1=在玩家<strong>已拥有</strong>龙宠中随机1只，作为限制龙宠（概率平均）</td>
</tr>
<tr>
<td>battlePassModeLimit</td>
<td>Int</td>
<td>0=不进行限制  1=在玩家<strong>已解锁</strong>模式中随机1个作为限制模式（概率平均）</td>
</tr>
</tbody></table>
<ul>
<li><p>以上两个字段都配置为1时，随机取其一作为限制条件（概率平均）</p>
<ul>
<li>有一者为0，取另一字段作为限制条件。</li>
<li> 都为0则不抽取该条信息。</li>
</ul>
</li>
<li><p>抽取方式：</p>
<ul>
<li><p> 在<code>randomNum</code>中取得抽取次数，在对应<code>chainId</code>中抓取等额次数的任务，不存在抓空。</p>
</li>
<li><p> 概率：概率在对应<code>chainId</code>的<code>task_base</code>中的<code>probability</code>字段体现。</p>
</li>
</ul>
</li>
</ul>
<h4><span id="412-新增任务规则">4.1.2 新增任务规则</span></h4><ul>
<li><p><code>task_control</code>配置表新增<code>ruleType=4</code>，表示在龙宠与模式中进行随机限制。</p>
<ul>
<li><p> 表示随机任务，去指定<code>chainId</code>中抽取任务时，需进行以下操作：</p>
</li>
<li><p>根据battlePassPetLimit字段，查询玩家目前<strong>已拥有</strong>龙宠，在已拥有龙宠中选定1只（概率平均），限制玩家仅使用该龙宠才可完成任务。</p>
</li>
<li><p>根据battlePassModeLimit字段，查询玩家目前<strong>已解锁</strong>模式，在已解锁模式中选定1个（概率平均），限制玩家仅使用该模式才可完成任务。</p>
</li>
<li><p>任务限制模式、龙宠信息需形成消息下发客户端。</p>
</li>
</ul>
</li>
<li><p> <code>task_control</code>配置表新增<code>ruleType=5</code>，表示战令限制随机任务，去<code>chainId</code>中抽取任务时，需进行以下操作：</p>
</li>
<li><p>查询玩家<strong>是否已购买战令</strong>，已拥有战令才可进行任务（任务会先下发，但需购买战令才可进行并完成）。</p>
</li>
</ul>
<h4><span id="413-新增重置规则与字段">4.1.3 新增重置规则与字段</span></h4><ul>
<li>task_control配置表字段<code>randomDays#int</code>，表示每X（配置天数）自然日可读取<code>randomNum#int</code>进行任务抽取，当<code>ruleType=4/5</code>时才读取该字段信息。</li>
</ul>
<table>
<thead>
<tr>
<th>字段</th>
<th>类型</th>
<th>释义</th>
</tr>
</thead>
<tbody><tr>
<td>randomDays</td>
<td>Int</td>
<td>每X自然日可去randomNum中执行抽取，也表示1个赛季内该实例任务每X自然日刷新一次</td>
</tr>
</tbody></table>
<ul>
<li><p>当<code>ruleType=4/5</code>时，进行以下处理：</p>
<ul>
<li>到<code>randomDays</code>读取自然日信息，判断当前赛季经过的自然日天数，以此为基准执行抽取。<ul>
<li> 例：<code>randomDays</code>的配置值为<code>5</code>，<code>randomNum</code>配置值为<code>4</code>，当前赛季已进行了16个自然日。玩家（当日注册新号）此时登录游戏触发了战令任务抽取业务，则执行4次（包含跨赛季第1次）抽取流程，下发数量共16个任务给玩家。</li>
</ul>
</li>
</ul>
</li>
<li><p>在1个赛季内，ruleType=4/5的任务都可完成，<strong>跨赛季后任务清零</strong>，并执行1次抽取（跨赛季后第1次抽取无需满足配置的自然日条件）。</p>
</li>
</ul>
<h4><span id="414-新增任务条件">4.1.4 新增任务条件</span></h4><ul>
<li> 根据战服传出数据，新增以下任务类型</li>
</ul>
<table>
<thead>
<tr>
<th>任务条件id</th>
<th>任务类型描述</th>
<th>target数量</th>
</tr>
</thead>
<tbody><tr>
<td>100240</td>
<td>恢复生命</td>
<td>数量</td>
</tr>
<tr>
<td>100250</td>
<td>造成伤害</td>
<td>数量</td>
</tr>
</tbody></table>
<h4><span id="415-逐级解锁">4.1.5 逐级解锁</span></h4><ul>
<li><code>task_control</code>配置表中的<code>levelLimit#int</code>字段将配置任务的生成等级，玩家只有达到了配置值，才可生成任务实例。</li>
</ul>
<h4><span id="416-数据下发">4.1.6 数据下发</span></h4><ul>
<li><p>服务端需下发以下信息，供客户端维护：</p>
<ul>
<li><p><code>ruleType=4</code>，<code>resetRule=2</code>时（战令每日任务）</p>
<ul>
<li>下发<code>ruleType</code>与<code>resetRule</code>值</li>
<li>下发任务条件、任务奖励、任务限制信息（龙宠或模式）</li>
<li>下发任务刷新时间戳</li>
</ul>
</li>
<li><p><code>ruleType=4</code>，<code>resetRule=3</code>时（战令赛季任务）</p>
<ul>
<li><p>下发<code>ruleType</code>与<code>resetRule</code>值</p>
</li>
<li><p>下发任务条件、任务奖励、任务限制信息（龙宠或模式）</p>
</li>
<li><p>下发任务刷新时间戳</p>
</li>
</ul>
</li>
<li><p><code>ruleType=5</code>，<code>resetRule=3</code>时（战令赛季任务）</p>
<ul>
<li>下发<code>ruleType</code>与<code>resetRule</code>值</li>
<li>下发任务条件、任务奖励、任务限制信息（龙宠或模式）</li>
<li>下发任务刷新时间戳</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3><span id="43-战服相关">4.3 战服相关</span></h3><h4><span id="431-数据下发">4.3.1 数据下发</span></h4><ul>
<li><p>统计战局内以下数据，向平台下发:</p>
<ul>
<li><p>恢复生命（使用治疗类技能，恢复他人生命也计算在内）。</p>
</li>
<li><p>造成伤害（仅对敌方角色造成伤害计算在内，吃鸡模式宝箱、其他玩家的召唤物不计算在内）。</p>
</li>
</ul>
</li>
</ul>
<h3><span id="44-客户端相关">4.4 客户端相关</span></h3><h4><span id="441-数据处理">4.4.1 数据处理</span></h4><ul>
<li><p>处理服务端下发的任务消息中的数据，判断任务类型，根据不同任务类型做差异表现。</p>
</li>
<li><p>以下<code>chainId</code>在客户端为<code>taskType</code>：</p>
<ul>
<li><p><code>chainId=5000</code>，表示战令每日任务。</p>
</li>
<li><p><code>chainId=5011/5012</code>，<code>ruleType=4</code>，表示战令赛季任务。</p>
</li>
<li><p> <code>chainId=5011/5012</code>，<code>ruleType=5</code>，表示战令赛季任务（需购买战令才可进行并完成）。</p>
</li>
</ul>
</li>
<li><p>处理每个任务的限制条件，条件分为：龙宠、模式。</p>
</li>
</ul>
<h4><span id="442-任务界面-任务排序规则">4.4.2 任务界面-任务排序规则</span></h4><ul>
<li><p>根据平台下发消息，对任务进行排序，规则如下：</p>
</li>
<li><p>任务（收起）：</p>
<ul>
<li><p>优先1：可领取态优先展示（包含每日与赛季），后方跟随相同龙宠或限制模式任务（如果有），若玩家此时执行了领取任务操作，不会进行重新排序。</p>
</li>
<li><p> 优先2：完成进度最高的任务（进行态，包含每日与赛季），后方跟随相同龙宠或限制模式任务（如果有）。</p>
</li>
<li><p> 优先3：同一限制条件（相同限制龙宠或相同限制模式）的进行态任务，自动对齐（卡片归类到同一处）；若玩家解锁了战令，战令赛季任务也可参与对齐。</p>
</li>
<li><p> 优先4：没有其他可进行任务时，展示未解锁的战令专属任务。</p>
</li>
<li><p>例：收起态有3个slot，玩家未解锁战令，目前玩家剩余1个赛季任务与若干个赛季战令任务，slot1展示赛季任务，slot2/3展示未解锁态的战令专属任务。</p>
</li>
<li><p>优先5：客户端作假维护的待刷新态卡片。</p>
</li>
</ul>
</li>
<li><p>任务（展开），展开时会根据任务类型分类，每日任务不参与下列排序：</p>
<ul>
<li><p>优先1：同一限制条件（相同限制龙宠或相同限制模式）的任务，自动对齐（卡片归类到同一处）；若玩家解锁了战令，战令专属任务也可参与对齐。</p>
</li>
<li><p>优先2：玩家未解锁战令时，所有已下发但不可完成的战令专属任务，始终显示在展开态的末尾。</p>
</li>
<li><p>优先3：客户端作假维护的待刷新态卡片。</p>
</li>
</ul>
</li>
</ul>
<h4><span id="443-任务界面交互-收起态">4.4.3 任务界面交互-收起态</span></h4><ul>
<li>任务为收起状态时，交互如下图所示：</li>
</ul>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hislikjf4sj30zg0jfnc7.jpg" alt="image.png"></p>
<ul>
<li><p>收起态时，任务界面内由上到下有3个slot，为slot1、slot2、slot3，分别展示收起态排序前3的任务。</p>
<ul>
<li><p>其中slot内含有任务卡片，卡片主要包含以下2个状态；（待刷新态与战令专属态在下文：展开态中描述）。</p>
<ul>
<li><p>可领取态（根据上文排序，优先级最高），包含以下内容：</p>
<ul>
<li>主题图标（根据平台下发的限制条件去<code>item_base</code>或<code>mode_sty</code>索引）。</li>
<li> 任务文本（<code>task_base</code>）。</li>
<li> 可领取蒙版、底板。</li>
</ul>
</li>
<li><p>玩家点击了可领取态slot的卡片，按顺序执行以下动效：</p>
<ul>
<li><p>动效1：经验图标从卡片处飞向左上角，左上角进度条组件执行增加表现，战令主进度条执行增加表现。</p>
<ul>
<li>若增加过程中经过了对应节点圆形图标，节点需从未解锁态变为解锁态并播放光效。</li>
<li>对应节点的奖励（免费奖励、战令奖励）需从未解锁态变为解锁可领取态，可领取态需展示太阳花光效。</li>
</ul>
</li>
<li><p>动效2：卡片播放透明度由100%到0%消失的0.35秒先慢后快弹性动画。</p>
</li>
<li><p>动效3：列表推进动画：若玩家点击的是slot1的可领取卡片，slot2的卡片向上移变为slot1，slot3的卡片向上移变为slot2，通过排序新增一张卡片从下方移入界面填充slot3；动画为持续1秒的慢（100%）→快（150%）→慢（100%）的弹性移动动画。</p>
<ul>
<li>若玩家点击的是slot2的可领取卡片，slot3的卡片向上移变为slot2，通过排序新增一张卡片从下方移入界面填充slot3。</li>
<li>若玩家点击的是slot3，通过排序新增一张卡牌从下方移入界面填充slot3。</li>
</ul>
</li>
</ul>
</li>
<li><p>已领取的任务卡片不再展示</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>进行态包含以下内容：</p>
<ul>
<li>主题图标（根据平台下发的限制条件去<code>item_base</code>或<code>mode_sty</code>索引）。</li>
<li> 任务文本（<code>task_base</code>）+限定龙宠/模式 ：%s（具体索引id见字符串配置处）。</li>
<li>任务目标与进度条（<code>task_base</code>）。</li>
<li>任务奖励（task_base）。</li>
<li>玩家点击了进行态的卡片，执行以下操作<ul>
<li> 若该任务的限制条件为指定龙宠，返回主界面切换为对应龙宠；玩家在房间内时队伍内有相同龙宠则展示code=104010</li>
<li>若该任务的限制条件为指定模式，返回主界面切换为对应模式；玩家在房间内且不为队长时展示code=21101</li>
</ul>
</li>
</ul>
</li>
<li><p> 点击红框内热区，将任务界面变为：展开态，按顺序执行以下动效：</p>
</li>
</ul>
<p> <img src="https://fc.sinaimg.cn/large/00724HnBly1hisls7g4k7j30q90qk48n.jpg" alt="image.png"></p>
<ul>
<li><p>动效1：3个slot内的卡片播放大小由100%到0%的0.35秒先慢后快弹性动画。</p>
</li>
<li><p>动效2：任务展开态由屏幕右侧至左以先慢后快弹性动画形式进入界面，参照聊天功能抽屉动画。</p>
</li>
</ul>
<h4><span id="444-任务界面交互-展开态">4.4.4 任务界面交互-展开态</span></h4><ul>
<li> 任务为展开状态时，交互如下图所示</li>
</ul>
<p> <img src="https://fc.sinaimg.cn/large/00724HnBly1hisly5zarqj31750nmnfi.jpg" alt="image.png"></p>
<ul>
<li><p>任务主题1（展示每日任务卡片）：</p>
<ul>
<li><p>主题文本：“每日任务”（UI层已有，直接复用）。</p>
</li>
<li><p>倒计时文本：“刷新倒计时：”（UI层发布，需翻译）。</p>
</li>
<li><p>需程序自行换行后展示倒计时，附带倒计时图标，倒计时根据平台下发的该任务链刷新时间戳展示，每日任务倒计时跟随主题文本形成组件，会随界面拖动移动。</p>
</li>
<li><p>具体倒计时显示规则复用上层战令功能。</p>
</li>
</ul>
</li>
<li><p>任务主题2（展示赛季任务、战令专属任务卡片）：</p>
<ul>
<li>主题文本：“赛季任务”（UI层已有，直接复用）。</li>
<li>倒计时文本：“新任务解锁：”（UI层发布，需翻译）。</li>
<li>需程序自行换行后展示倒计时，附带倒计时图标，倒计时根据平台下发的该任务链刷新时间戳展示，赛季任务倒计时固定在屏幕右侧，不会随界面拖动移动。</li>
<li>具体倒计时显示规则复用上层战令功能。</li>
</ul>
</li>
<li><p>展开态可左右拖动查看更多卡片：</p>
<ul>
<li>初始展开界面时，每日任务标题与卡片组件定位最左侧，此时界面不可向右拖动。</li>
<li>初始向左拖动时，每日任务组件跟随卡片可根据拖动移出到界面外，赛季任务标题组件与卡片可随拖动移动到左侧，如图。</li>
<li>赛季任务标题到左侧时不会移动到屏幕外，继续拖动将只移动赛季任务的卡片部分。<ul>
<li>此时向右拖动到底每日任务组件可回到界面内。</li>
</ul>
</li>
</ul>
</li>
<li><p>展开态时，任务界面内由左到右有若干个slot，按上文（任务排序规则）提到的排序展示任务。</p>
<ul>
<li><p>其中slot内含有任务卡片，卡片主要包含可领取态与进行态（样式复用4.4.3收起态的描述），及以下状态：</p>
</li>
<li><p>可领取态：</p>
<ul>
<li>在界面展开状态点击可领取态的任务时，展开态关闭为收起态，播放领取已完成任务的相关动效（4.4.3可领取态动效）。</li>
<li>此时同时进行收起态的slot维护，不会将点击完成的任务填充进收起态的slot1。</li>
<li>已领取的赛季任务卡片不再展示，在展开态中需判断任务类型。<ul>
<li>若为每日任务，则领取完后需在对应slot处展示待刷新态卡片。</li>
</ul>
</li>
</ul>
</li>
<li><p>进行态：点击进行态的任务，执行4.4.3进行态中相同的描述。</p>
</li>
<li><p>战令专属态（未解锁态）：卡片任务进度条与奖励处盖有蒙版，蒙版上方展示文字：“战令专属任务”</p>
</li>
<li><p>待刷新态</p>
<p><img src="https://fc.sinaimg.cn/large/00724HnBly1hism324atgj30k10aajt9.jpg" alt="image.png"></p>
<ul>
<li>作假表现，客户端自行维护展示，如下图展示，该卡片无点击事件</li>
<li>如图该卡片有两种样式，根据config（全局变量表）的key=300控制两种样式的生成数量<ul>
<li>Data1=等待刷新卡片的数量。</li>
<li>Data2=等待刷新（战令专属）卡片的数量。</li>
</ul>
</li>
</ul>
</li>
<li><p>根据排序，一般展示在其他形态卡片末尾，在没有其他可进行任务时，展示待刷新态卡片。</p>
</li>
<li><p>等待刷新（包含等待刷新 战令专属）的卡片符合对齐条件，应归类展示，但等待刷新 战令专属卡片，应展示在该类型卡片的末尾。</p>
</li>
</ul>
</li>
</ul>


        

        
            <div class="tags">
                <a class="tag-none-link" href="/tags/game-design/" rel="tag">game-design</a>
            </div>
        
    </section>
</article>
  
</section>



        <script>setLoadingBarProgress(15);</script>
    </main>

    <footer id="footer" class="clearfix">

    

    <div class="social-wrapper">
        
            
                <a href="https://weibo.com/u/2686174203" class="social sina-weibo"
                   target="_blank" rel="external">
                    <span class="icon icon-sina-weibo"></span>
                </a>
            
                <a href="https://www.instagram.com/jianzou1/" class="social instagram"
                   target="_blank" rel="external">
                    <span class="icon icon-instagram"></span>
                </a>
            
        
    </div>
    <div class="theme-by">© 2023</span><span class="codename"> Shelton</span>
    <span class="post-meta-divider">|</span>
    <span class="theme-by">Theme Colors By <span class="codename">PANTONE 18-1750 Viva Magenta</span>
    </div>

<!--     <div class="countAndRunTime">
    
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">PV:<span id="busuanzi_value_site_pv"></span></span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">UV:<span id="busuanzi_value_site_uv"></span></span>
    
    
    </span><br></span>
    <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span> <script language="javascript"> 
    var now = new Date();
    function createtime(){
        var grt= new Date("06/22/2021 22:02:52");/*---这里是网站的启用时间--*/
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24;
        dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum);
        hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;}
        minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes);
        if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds);
        if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "The site has been running for "+dnum+"d ";
        document.getElementById("times").innerHTML = hnum + "h " + mnum + "m " + snum + "s ";
        }
        setInterval("createtime()",250); 
    </script> 
    </div> -->
    

</footer>


    <script>setLoadingBarProgress(20);</script>
    <div class="overlay"></div>
</div>

<div class="site-sidebar" id="site-sidebar">

    

    <div class="sidebar-switch clearfix "
         style="display: none">
        <a class="dark-btn active" data-toggle="toc">
            <span class="icon icon-list"></span>
            <span class="text">Index</span>
        </a>
        <a class="dark-btn" data-toggle="bio">
            <span class="icon icon-person"></span>
            <span class="text">Bio</span>
        </a>
    </div>

    <div class="site-toc "
         style="display: none">
        
            <div class="no-index">No Index</div>
        
    </div>

    <div class="site-bio show"
         style="display: block">

        <div class="about-me clearfix">
            <div class="avatar">
                <img src="/img/avatar.png"/>
            </div>
            <div class="info">
                <a class="name dark-btn" href="/about">
                    间奏
                </a>
            </div>
            <div class="info">
                <span class="item desc">
                    Everyone is chasing their own dragon.
                </span>
            </div>
        </div>

        <div class="menu section">
            <ul class="clearfix">
                
                    <li class="left">
                        <a href="/about"
                           onfocus="this.blur();"
                           class="nav-about dark-btn block">
                            About
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/archives"
                           onfocus="this.blur();"
                           class="nav-archives dark-btn block">
                            Archives
                        </a>
                    </li>
                
                    <li class="left">
                        <a href="/tags/photography/"
                           onfocus="this.blur();"
                           class="nav-photography dark-btn block">
                            Photography
                        </a>
                    </li>
                
                    <li class="right">
                        <a href="/tags/game-design/"
                           onfocus="this.blur();"
                           class="nav-game design dark-btn block">
                            Game Design
                        </a>
                    </li>
                
            </ul>
        </div>

    </div>

    <div class="shortcuts">
        <a href="#header" class="top window-nav dark-btn" id="go-top">
            <span class="icon icon-chevron-thin-up"></span>
        </a>
        <a class="close dark-btn" id="sidebar-close">
            <span class="icon icon-close"></span>
        </a>
        <a href="#footer" class="top window-nav dark-btn" id="go-bottom">
            <span class="icon icon-chevron-thin-down"></span>
        </a>
    </div>

</div>





<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script>window.jQuery || document.write('<script src="/js/jquery.min.js"><\/script>')</script>


<script src="/js/jquery.fitvids.js"></script>

<script>
  var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
  var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
  var ALGOLIA_API_KEY = "";
  var ALGOLIA_APP_ID = "";
  var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var SEARCH_SERVICE = "";
  var universalSearchConfig = {};
  if (SEARCH_SERVICE === 'google') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: GOOGLE_CUSTOM_SEARCH_API_KEY,
      engineId: GOOGLE_CUSTOM_SEARCH_ENGINE_ID,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'algolia') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      apiKey: ALGOLIA_API_KEY,
      appId: ALGOLIA_APP_ID,
      indexName: ALGOLIA_INDEX_NAME,
      imagePath: "/img/"
    };
  } else if (SEARCH_SERVICE === 'azure') {
    universalSearchConfig = {
      searchService: SEARCH_SERVICE,
      serviceName: AZURE_SERVICE_NAME,
      indexName: AZURE_INDEX_NAME,
      apiKey: AZURE_QUERY_KEY,
      imagePath: "/img/"
    };
  }
</script>

<script src="/js/app.js"></script>


<script src="/js/search.js"></script>





<script>setLoadingBarProgress(100);</script>

</body>
</html>
